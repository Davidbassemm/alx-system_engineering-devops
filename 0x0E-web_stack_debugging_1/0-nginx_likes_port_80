#!/bin/bash

# Check Nginx status (silent)
systemctl status nginx >/dev/null 2>&1
if [[ $? -ne 0 ]]; then
  exit 1  # Exit with failure code if not running
fi

# Check for conflicting process on port 80 (silent)
process=$(netstat -tlpn | grep ":80\sTCP.*LISTEN")

# Stop conflicting process if found (silent)
if [[ ! -z "$process" ]]; then
  pid=$(echo "$process" | awk '{print $7}')
  kill $pid >/dev/null 2>&1
fi

# Fix Nginx config (modify as needed)
sed -i 's/listen [^:]*:\([0-9]*\);/listen 80;/' /etc/nginx/nginx.conf

# Restart Nginx (silent)
systemctl restart nginx >/dev/null 2>&1

# No output messages
exit 0
